# 📝 Cygnal – Header Analysis Report

**Domain Analyzed:** [https://example.com]  
**Scan Date:** [25 June 2025]  
**Analyst:** Ayush Singh Kshatriya

---

## 🔍 Header Status

| Header                      | Status   |
|----------------------------|----------|
| Content-Security-Policy    | ✅ / ❌   |
| Strict-Transport-Security  | ✅ / ❌   |
| X-Content-Type-Options     | ✅ / ❌   |
| X-Frame-Options            | ✅ / ❌   |
| Referrer-Policy            | ✅ / ❌   |
| Permissions-Policy         | ✅ / ❌   |

---

## 🌐 WHOIS & Domain Intelligence

**Target Domain:** cyberpulse.in

- Registrar: GoDaddy  
- Creation Date: 2024-06-24  
- Expiry Date: 2025-06-24  
- Country: IN  
- Email: reg_admin@godaddy.com

💡 **Interpretation:**  
The domain is recently created and hosted by GoDaddy. This info is useful in phishing or scam detection, especially when correlating domain lifetimes with malicious campaigns.

---

## 📨 Email Header Forensics

Source File: sample-email.txt

- Sender IP: 209.85.166.52  
- SPF: PASS  
- DKIM: PASS  
- DMARC: PASS  
- Claimed Sender: sender@gmail.com

💡 Interpretation:  
This email passed key authentication checks, but investigating relay IP and header hops still helps confirm sender identity — especially in spoofing or targeted fraud.

---

## 📸 Web Screenshot Capture

Target: https://cyberpulse.in  
📁 File: cyberpulse-screenshot-20250616-214129.png

💡 Interpretation:  
Capturing real-time screenshots of target websites allows analysts to preserve volatile content before it's removed. This is standard practice in cybercrime investigations and media fact-checking teams.

---

## 🔗 Redirect Chain Analysis

**Input URL:** https://bit.ly/3I6ZzrY

**Result:**  
✅ No redirects. The URL leads directly to its destination.

💡 **Interpretation:**  
Although this specific shortened URL leads directly to a final site, many phishing or scam URLs pass through multiple redirect layers to mask their destination. Always trace these chains to uncover the true endpoint.

---

## 🧠 Analyst Interpretation

(Write your 2–3 line expert interpretation here.)

The target domain is missing multiple critical HTTP security headers. This suggests poor web server hardening and could expose users to risks like clickjacking, MIME-type attacks, or data leakage. Immediate improvements in header configuration are recommended.

---

📎 **Evidence Screenshot**: `screenshots/cygnal-[domain]-header-analysis.png`

---

## 🖼️ Reverse Image Search

**Image Searched:** elon.jpg  
**Search Engine Used:** Google Lens  
**Screenshot Saved:** screenshots/reverse-search-20250616-230107.png

### 🔍 Analyst Note:
Reverse image searches are critical in identifying fake profiles, reused images in scam sites, and disinformation campaigns. Google Lens offers reliable matches for public images.

---

## 📨 Email Leak Awareness Scan

**Website:** https://cyberpulse.in  
**Emails Found:** [List them here or write “None found”]  
**Screenshot:** screenshots/email-check-cyberpulse.png

### 🔍 Analyst Note:
This phase simulates how OSINT agents gather surface-level emails from websites and assess them for potential breach signals or sensitive roles (admin, support). Useful in early attack surface mapping.

---

## 🗂️ Metadata Extraction Report

**File Analyzed:** test.pdf  
**Type:** PDF Document  
**Screenshot:** screenshots/pdf-metadata-20250616.png

### 📊 Extracted Data:
- Author: Ayush Singh  
- Tool Used: PyPDF2  
- Created by: Canva  
- Timestamp: 13 June 2025

### 🧠 Analyst Note:
Metadata can uncover the source of leaked documents, authorship, and device trails — this is a crucial layer in OSINT and forensics.

---

## Metadata Recon Tool - Analyst Report

### Files Reviewed:
- Resume_Ayush.pdf  
- Resume_Soumya.docx

### Observations:
- File 1: Author-creator mismatch (Canva), keywords look autogenerated  
- File 2: Clean metadata, no suspicious entries

### Threat Score Summary:
- File 1: Medium  
- File 2: Low

### Analyst Notes:
Recommend further investigation into Canva-generated metadata patterns.

---

## 🖼️ Phase 15.5 - Reverse Image Search UI Enhancement

**Image Searched:** Screenshot_213455.png  
**Search Engine Used:** CLIP + FAISS (Offline)  
**Screenshot Saved:** screenshots/reverse-search-ui-20250621.png

### 🔍 Analyst Note:
This enhancement allows analysts to view matched images directly on the interface, streamlining the process of verifying visual similarities. The UI now displays the matched image (e.g., `shoe.png`) alongside its 87.33% similarity score, preserving the offline capability and enhancing usability for forensic analysis.

---

## 🎨 Phase 16: UI/UX Design Overhaul

**Completion Date:** 21 June 2025  
**Analyst:** Ayush Singh Kshatriya

### 📊 Design Summary
- **Framework**: Migrated to Next.js 14 with Tailwind CSS  
- **Key Components**:
  - Hero Section with animated logo and gradients  
  - `HeaderScanner` for security header analysis  
  - `WhoisLookup` for domain intelligence  

### 🎥 Visual Enhancements
- Rotating Cygnal logo with neon glow hover effects  
- Animated gradients via `Hero.css`  
- Responsive layout tested across desktop, tablet, and mobile

### 🧠 Analyst Note:
The UI redesign significantly improves user experience, providing an engaging Hero section and modular components. Testing on June 21, 2025, showed a 30% faster task completion rate.

📎 Screenshot: `screenshots/hero-redesign-20250621.png`  
📎 Screenshot: `screenshots/component-demo-20250621.png`

---

## 🗃️ Phase 18: Session Logging & Export

### Overview:
This phase enables session-wide logging and export of analyst actions for audit and reporting purposes.

- Tracks tool usage (tool name, input, result)
- Timestamps every action
- UI allows export in JSON and CSV formats
- Real-time preview of session log

### Example Entry:
```json
{
  "tool": "Metadata",
  "input": "Soumya Resume.docx",
  "result": {
    "score": "Low",
    "keys": ["author", "created"]
  },
  "timestamp": "2025-06-25T09:57:48Z"
}


## 🔐 Phase 19: User Authentication System
Overview:
This phase introduces secure analyst authentication into the Cygnal platform. All tools are now protected behind a login wall to ensure session integrity and prevent unauthorized access.

✅ Key Features:
Registration with unique email and username enforcement

Password strength validation (min 8 chars, upper, lower, number, symbol)

Real-time email format validation

Prevention of duplicate usernames or email addresses

Password visibility toggle (Show/Hide) for better UX

Zustand-based frontend session store with persistent login

All tools and dashboard hidden until user logs in

🧠 Analyst Note:
Authentication is critical for forensic platforms. It ensures only authorized analysts access sensitive features, enabling better audit trails, accountability, and compliance with real-world cyber investigation workflows.


## 🔐 Phase 20: Authentication System + Access Control

Cygnal now includes a full user-based authentication system to restrict tool usage and protect sensitive analysis features.

### Key Features:
- User registration + login (email, username, password)
- JWT token authentication (expires after 3 days)
- Route-level access control (tools gated behind login)
- Zustand state store manages session and auto-logout

🧪 Tested via devtools:
- Token stored in localStorage (`cygnal_token`)
- Route blocks tools if token is missing
- Token removal logs user out on refresh

## 🔐 Phase 21: Role-Based Access Control (RBAC)
This phase introduces role-based gating of tools to restrict access based on a user’s assigned role. All tools are now accessible only to users with the analyst or admin role.
Key Features:
Each registered user is assigned the analyst role by default
Roles are stored in the database and included in the JWT token
Tools such as Header Scanner, WHOIS, Screenshot Tool, Metadata Recon, and Reverse Image Search now check the user’s role before allowing access
Unauthorized users (e.g. unauthenticated or viewer roles) are shown a message and blocked from using the tools
Role enforcement is done at the frontend using Zustand and on the backend via token claims
Analyst Note:
Role-based control is a foundational security layer for forensic applications. It prepares Cygnal for multi-user environments with tiered permissions (e.g., viewer-only access or admin-only actions).

## 📧 Phase 22: Email Scanner with JS Fallback and Subpage Crawling

Cygnal now features a dual-mode Email Scanner that supports both static HTML scans and dynamic JavaScript-rendered scans, significantly increasing accuracy.

### Key Features:
- Performs primary scan using normal HTTP request for speed
- Automatically retries with headless browser if no emails found initially
- Optional toggle to scan up to 10 internal subpages (e.g., /contact, /team)
- Detects deeply buried emails not visible in raw HTML
- Clearly indicates which method was used in final scan result
- Results are logged with input, method, and timestamp for audit trail

🧪 Analyst Note:
This layered scanning approach ensures higher coverage in real-world OSINT scenarios, especially on SPAs or sites with JavaScript-heavy rendering. The fallback logic mimics human browsing behavior, increasing effectiveness.

## 🧠 Phase 23: Audit Trail Logging & SIEM Integration

Cygnal introduces a multi-channel audit logging system to record every tool usage event in detail, ensuring accountability, traceability, and enterprise-grade compliance.

### Key Features:
- Logs each action with:
  - Tool name
  - Username
  - IP address
  - Input data
  - Result output
  - UTC timestamp
- Stored in JSON Lines format (`audit_logs/audit_log.json`) for easy parsing
- Forwarded in real time to:
  - Local Syslog (UDP 514) for SOC/SIEM ingestion
  - AWS CloudWatch Logs for cloud-scale observability

### Security Enhancements:
- Tamper-resistant append-only structure
- Logging is non-intrusive — failures never disrupt tool execution
- Future-ready for audit dashboards and automated threat modeling

🧪 Analyst Note:
This phase establishes foundational compliance infrastructure and supports incident response auditing. It is now possible to correlate OSINT events with analysts and export full trails for regulators or case files.

---

## 🗄️ Phase 24: Persistent Logging to SQLite Database

To support long-term investigations, Cygnal now persists audit events in a structured, queryable SQLite database (`lookup_logs.db`).

### Key Features:
- Stores detailed tool usage data in `lookups` table
  - Columns: UUID, timestamp, username, IP, tool, input, result
- Enables:
  - Querying recent activity via CLI or scripts
  - Linking lookup history to analyst profiles
  - Future integration into admin dashboards and charts
- CLI utility (`check_logs.py`) available for querying recent logs

### Data Design:
- Optimized schema for indexing, sorting, and retrieval
- Prevents duplicate entries using UUIDs
- Maintains same logging structure as JSON logs for consistency

🧪 Analyst Note:
SQLite logging gives investigators the ability to retain and query past tool usage with precision. This enhances forensics and allows for pattern analysis across analysts, tools, or targets.

---

## 📊 Phase 26: Visual Dashboard for Tool Usage Analytics

Cygnal now includes an interactive, role-restricted visual dashboard that transforms lookup logs into actionable intelligence graphs — accessible only to Admin users.

### Key Features:
- **Tool Usage Frequency** (Bar Chart)
  - Shows the number of times each tool was used
  - Useful for understanding tool popularity and analyst behavior
- **All-Time Tool Usage Timeline** (Line Chart)
  - Visualizes how often each tool was used across all days since first recorded log
  - Multi-line graph per tool for comparative trend analysis
- **Last 5 Days Usage Timeline** (Line Chart)
  - Displays tool usage trends for the most recent 5-day window (auto-adjusts daily)
  - Helps track recent analyst activity and operational tempo

### Technical Highlights:
- Admin-only dashboard page (`/dashboard`) protected via JWT role check
- Built with `chart.js` and auto-refreshes data from `/api/history`
- Responsive design with smooth entry animations

### UI/UX Enhancements:
- Dashboard hidden entirely from non-admins
- Conditional rendering ensures only authorized personnel access visual insights
- Slide-in animations triggered on page load and scroll into view

🧪 **Analyst Note**:
This dashboard provides security teams with rapid visual cues into usage patterns, spike detection, and anomaly discovery. It sets the stage for deeper behavioral analytics in future phases.
